#!/bin/hush
#   ---------------------------------------------
#   Common settings
#   ---------------------------------------------
HOSTNAME=df3120
VERSION=0.0.1

BT_ADDRESS="84:59:04:04:02:05"

NFS_SERVER="192.168.178.10"

NFS_EXPORT="/exports/df3120-rootfs"

. /etc/init.d/functions.sh

hostname $HOSTNAME

header

#   ---------------------------------------------
#   mounting file systems
#   ---------------------------------------------
echo -n "* Mounting filesystems"
mkdir -p /dev/pts /dev/shm
mount -a
status $? 1

#   ---------------------------------------------
#   MDEV Support
#   ---------------------------------------------
echo -n "* Creating devices"
/sbin/mdev -s
status $? 0

mount / -o remount,rw

#echo 2 >/proc/cpu/alignment

#   ---------------------------------------------
#   start loggers
#   ---------------------------------------------
echo -n "* Starting syslogd"
/sbin/syslogd -C16
status $? 0

echo -n "* Starting klogd"
/sbin/klogd
status $? 0

#   ---------------------------------------------
#   inits the loopback device
#   ---------------------------------------------
ifconfig lo 127.0.0.1 up

#   ---------------------------------------------
#   inits the network devices
#   ---------------------------------------------
echo -n "* Network "

usb0_init

connected=$?

#   ---------------------------------------------
#   network services
#   ---------------------------------------------

[ ! $connected -eq 0 ] && {
  echo "* Starting network services -->"
} || {
  exit
}

case $connected in
1) startUsbNetworkServices
   start_apps
   ;;
2)
   ;;

esac

# Disable console blanking
printf "\e[9;0]" >/dev/tty0
